<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>IELTS Listening – Section 1</title>

<!-- 载入题库文件 -->
<script src="questions.js"></script>

<style>
body {
    font-family: Arial, sans-serif;
    max-width: 760px;
    margin: auto;
    padding: 25px;
    line-height: 1.6;
}

h1 {
    text-align: center;
    font-weight: bold;
    margin-bottom: 25px;
}

.inst-block {
    background: #f7f7f7;
    border-left: 4px solid #333;
    padding: 18px;
    margin: 20px 0;
}

.inst-title {
    font-size: 18px;
    font-weight: bold;
    margin-bottom: 5px;
}

.question {
    margin-top: 18px;
    font-weight: bold;
}

input[type="text"] {
    width: 100%;
    padding: 8px;
    margin-top: 6px;
    font-size: 15px;
}

.options {
    margin-left: 20px;
    margin-top: 6px;
}

/* 雅思机考：音频条可见但禁用所有控制 */
audio {
    width: 100%;
    margin-top: 20px;
    pointer-events: none;
}

/* 倒计时样式 */
#countdown {
    font-size: 20px;
    font-weight: bold;
    text-align: center;
    color: #b30000;
    margin-bottom: 20px;
}
</style>
</head>

<body>

<h1>SECTION 1 — Questions 1–10</h1>

<!-- 倒计时 -->
<div id="countdown">
    You now have some time to look at Questions 1–10.<br>
    The recording will begin in <span id="cd">10</span> seconds.
</div>

<!-- 音频播放器（不可操作） -->
<audio id="audioPlayer" controls preload="auto"></audio>

<!-- 题干区（倒计时后自动显示） -->
<div id="instructions" style="display:none;">
    <div class="inst-block">
        <div class="inst-title">Questions 1–6</div>
        Write <strong>NO MORE THAN TWO WORDS AND/OR A NUMBER</strong> for each answer.
    </div>
</div>

<form id="testForm"></form>

<script>
/* -----------------------------
   载入 Section 1 数据
------------------------------*/
const data = window.PREMIUM_TEST1.section1;

/* 设置音频路径 */
const audio = document.getElementById("audioPlayer");
audio.src = data.audio;

/* -----------------------------
   渲染题目（自动分块）
------------------------------*/
const form = document.getElementById("testForm");

data.questions.forEach(q => {
    if (q.number === 7) {
        form.innerHTML += `
            <div class="inst-block">
                <div class="inst-title">Questions 7–10</div>
                Choose the correct letter <strong>A, B or C</strong>.
            </div>
        `;
    }

    let html = `<div class="question">${q.number}. ${q.question}</div>`;

    if (q.type === "blank") {
        html += `<input type="text" id="q${q.number}" />`;
    }

    if (q.type === "mcq") {
        html += `<div class="options">`;
        q.options.forEach((opt, i) => {
            html += `
                <label>
                    <input type="radio" name="q${q.number}" value="${opt}">
                    ${String.fromCharCode(65 + i)}. ${opt}
                </label><br>`;
        });
        html += `</div>`;
    }

    form.innerHTML += html;
});

/* -----------------------------
   倒计时 10 秒 → 自动播放音频
------------------------------*/
let timeLeft = 10;
let cdSpan = document.getElementById("cd");

const previewTimer = setInterval(() => {
    cdSpan.textContent = timeLeft;
    timeLeft--;

    if (timeLeft < 0) {
        clearInterval(previewTimer);

        // 隐藏倒计时，显示题干
        document.getElementById("countdown").style.display = "none";
        document.getElementById("instructions").style.display = "block";

        // 自动播放（兼容 iOS）
        audio.muted = true;
        audio.play().then(() => {
            audio.muted = false;
        }).catch(() => {
            document.body.addEventListener("click", () => {
                audio.muted = false;
                audio.play();
            }, { once: true });
        });
    }
}, 1000);

/* -----------------------------
   音频播放完 → 立刻跳到 Section 2
   （你的音频已包含 30 秒检查时间）
------------------------------*/
audio.addEventListener("ended", () => {
    window.location.href = "section2.html";
});
</script>

</body>
</html>
