<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>IELTS Listening – Section 1</title>

<script src="questions.js"></script>

<style>
    body {
        font-family: Arial, sans-serif;
        max-width: 760px;
        margin: auto;
        padding: 25px;
        line-height: 1.6;
    }

    h1 {
        text-align: center;
        font-weight: bold;
        margin-bottom: 25px;
    }

    /* 倒计时区块 */
    .countdown-box {
        background: #fff3f3;
        border-left: 4px solid red;
        padding: 15px;
        margin-bottom: 25px;
        text-align: center;
        font-size: 18px;
        font-weight: bold;
        color: #c00;
    }

    /* 提示框 */
    .inst-block {
        background: #f7f7f7;
        border-left: 4px solid #333;
        padding: 18px;
        margin: 25px 0;
    }

    .inst-title {
        font-size: 18px;
        font-weight: bold;
        margin-bottom: 10px;
    }

    .question {
        margin-top: 18px;
        font-weight: bold;
    }

    input[type="text"] {
        width: 100%;
        padding: 8px;
        margin-top: 6px;
        font-size: 15px;
    }

    .options {
        margin-left: 20px;
        margin-top: 6px;
    }

    /* 禁止点击 audio 控件（Safari/Chrome） */
    audio::-webkit-media-controls-panel {
        pointer-events: none !important;
    }

    /* 播放器容器，使遮罩能覆盖 */
    .audio-wrapper {
        position: relative;
        margin: 20px 0;
    }

    /* 完全透明但阻止所有交互的遮罩 */
    .audio-blocker {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: auto;
        background: transparent;
    }
</style>
</head>

<body>

<h1>SECTION 1 — Questions 1–10</h1>

<!-- 倒计时区块 -->
<div id="countdownBox" class="countdown-box">
    <div>You now have some time to look at Questions 1–10.</div>
    <div id="countdownText">The recording will begin in 10 seconds.</div>
</div>

<!-- 音频播放器（默认禁用交互） -->
<div class="audio-wrapper">
    <audio id="audioPlayer"
        src="/public/audio/premium/test1/Listening_Test_1_SECTION_1.mp3"
        controls></audio>

    <!-- 透明遮罩层，用来完全阻止点击/拖动 -->
    <div class="audio-blocker"></div>
</div>

<!-- 题干：Questions 1–6 -->
<div class="inst-block">
    <div class="inst-title">Questions 1–6</div>
    <p>Write <strong>NO MORE THAN TWO WORDS AND/OR A NUMBER</strong> for each answer.</p>
</div>

<form id="testForm"></form>

<!-- 题干：Questions 7–10 -->
<div class="inst-block" style="margin-top:35px">
    <div class="inst-title">Questions 7–10</div>
    <p>Choose the correct letter <strong>A, B or C.</strong></p>
</div>

<script>
/* ===========================
   加载题库数据
=========================== */
const test = window.PREMIUM_TEST1.section1;
const form = document.getElementById("testForm");

/* ===========================
   渲染题目
=========================== */
test.questions.forEach((q) => {
    let html = `<div class="question">${q.number}. ${q.question}</div>`;

    if (q.type === "blank") {
        html += `<input type="text" id="q${q.number}" />`;
    }

    if (q.type === "mcq") {
        html += `<div class="options">`;
        q.options.forEach((opt, idx) => {
            html += `
                <label>
                    <input type="radio" name="q${q.number}" value="${opt}">
                    ${String.fromCharCode(65 + idx)}. ${opt}
                </label><br>`;
        });
        html += `</div>`;
    }

    form.innerHTML += html;
});

/* ===========================
   倒计时控制
=========================== */
let timeLeft = 10;
const countdownText = document.getElementById("countdownText");
const countdownBox = document.getElementById("countdownBox");
const audio = document.getElementById("audioPlayer");

const timer = setInterval(() => {
    timeLeft--;
    countdownText.textContent = `The recording will begin in ${timeLeft} seconds.`;

    if (timeLeft <= 0) {
        clearInterval(timer);
        countdownBox.style.display = "none";

        /* 自动播放音频 */
        audio.play().catch(() => {
            console.log("浏览器阻止自动播放，用户点击后将正常播放");
        });
    }
}, 1000);

/* ===========================
   音频结束 → 自动跳转 section2
=========================== */
audio.onended = function () {
    window.location.href = "section2.html";
};
</script>

</body>
</html>
